# shonichi

しょにち。初日。
一个为偶像制作开发的应用软件。目前软件实现的主要功能为拍摄分镜的设计辅助。
使用Flutter为跨平台开发框架，集成Firebase云服务，可部署于Android端、iOS端、Web端。
这是一个 **“专用”** 的App。其“专用”，体现在其主要用来辅助 **LoveLive、AKB48等偶像企划** 的 **宅舞的录制** ，且仅用于满足 **本作者** 的实际需求。
作者计算机方面技术力底下，没有条件将其发展为一个大范围公开的、通用的应用。
代码和文档可能有很多匪夷所思的地方，看个乐子就完了，不建议认真研究，更不建议Star&Fork。

## 功能简介

目前为止，本App提供了拍摄的计划阶段的一系列功能。
包括项目选择、分镜编辑、队形编辑、歌曲详情查看、歌曲列表查看、数据迁移。

### 项目管理

项目管理模块应提供有关项目(Project)对象的一系列操作。

在登录后，用户可以查看所有项目对象，并可进行创建、修改、删除操作。用户可以指定一个项目为当前进行项目，指定后可以在后续分支功能页面进行详细编辑。

### 分镜编辑

分镜编辑模块应提供有关分镜表(Storyboard)和分镜(Shot)对象的一系列操作。

用户进入分镜编辑页面后，可以查看所有分镜表对象，并可进行创建、修改、删除操作。用户可以指定一个分镜表为当前使用分镜表，指定后可以进行分镜的编辑。

一个分镜表对象由若干个分镜对象组合而成。分镜具有景别、角色、内容、画面等属性。用户可以分别使用下拉菜单、文本输入框等UI元素(Widget)对这些属性进行编辑，进行的更改会实时保存。

用户在编辑分镜时，软件可以根据现有的歌曲、队形、分镜等信息，为用户进行智能推荐，自动填充内容。

页面内应有检视器，对用户输入的数据进行统计，为用户提供全局的概览。
顶部显示当前项目的概览信息，如歌曲企划的名称。
其下显示当前各个成员的拍摄分镜的数量。用户可以据此数据合理设计分镜，保证所有被拍对象都有适当的出镜机会。
底部显示歌词覆盖情况。当分镜的起始时间与某一歌词相同时，该歌词将被高亮显示，代表有分镜“覆盖”了这一句歌词。用户可以据此了解分镜脚本的完成度。

### 队形编辑

队形编辑模块应提供有关队形(Formation)和移动(Movement)数据的一系列操作。

用户进入队形编辑页面后，可以查看所有队形数据，并可进行创建、修改、删除操作。用户可以指定一个队形为当前使用队形，指定后可以进行移动的编辑。

一个队形对象由若干个移动对象组合而成。这些移动对象共同表示了出镜角色随歌曲播放的位置移动、队形变换情况，而每一个单独的对象，则表示某角色在某时间下的具体移动信息。用户应可以通过拖动图形、调整曲线，编辑移动对象的属性，并可以预览队形的整体效果。

页面顶部为歌曲时间滑条。滑动以调整歌曲时间。
其下为角色选择按钮。其列出了当前项目的所有角色。
页面中间为当前时间下的队形情况预览，即所有角色的所处位置。
队形预览的左下方为关键帧曲线编辑。在角色、时间、曲线类型全部选定的后，此处将显示对应曲线。在此可以通过与MMD软件相似的操作，拖动左下方与右上方的锚点，调整该关键帧曲线。
右下方为曲线选择按钮。在此选择对X轴移动、或是Y轴移动曲线进行编辑。
右侧为关键帧列表，显示了当前项目的所有关键帧。在限定了时间以及角色时，显示内容将根据用户的选择被过滤。

### 歌曲详情查看

歌曲详情查看模块应提供项目关联歌曲的相关信息的查看功能。

一个歌曲对象由若干个歌词对象组合而成。歌词具有起止时间、歌词内容、Solo Part（歌曲中由某一人或某小组单独进行表演的部分）等属性。用户可通过lrc文件批量导入歌词数据。

右边的检视器为针对整个歌曲的一些信息。
顶部是当前企划的名称。
其下为视频播放器，与歌曲相关的视频，如官方PV、舞蹈教学等，将在此播放。

### 歌曲列表查看

歌曲列表查看模块应提供App中所有歌曲(Song)的信息的查看功能。

用户进入歌曲列表查看页面后，可以查看所有歌曲数据，并可进行创建、修改、删除操作。

### 数据迁移

数据迁移模块应提供将数据导入至App或从App导出的功能。

用户进入数据迁移页面后，可以从JSON文件导入数据，或选择将当前数据导出为JSON文件或Markdown文稿。用户可以设定密码，对导出的文稿进行加密，在加密文稿导入时可以进行解密。

## Getting Started

### iOS下的配置

* 本地文件存储

在Runner/Runner/Info.plist中加入如下的项，以启用iOS下的本地文件存储功能。

``` plist
    <key>LSSupportsOpeningDocumentsInPlace</key>
    <true/>
    <key>UIFileSharingEnabled</key>
    <true/>
```

### 初次使用

初次使用，登录后进入首页，将启动引导教程。
引导教程将指引用户新建一个项目，熟悉项目设计过程中的主要操作。

### 然后就根据功能介绍来使用吧

如题。

## 软件的一些其它信息

### 数据存储

使用Firebase Cloud Firestore作为远程数据库。数据不设本地存储方式。

### 后端文件存储

使用Firebase Cloud Storage实现文件存储。

* /images
歌曲封面
分镜图示

* /audios
歌曲

* /videos
官方PV

### 架构

View - Controller - Model - Repository - Provider

* Repository

将Provider的数据处理为合适的Model，提供给Controller使用。

* Provider

提供数据。

## 一个真实的故事

* 2020年7月

发现两个艰难的事实：

1. Flutter还是不够我用的，我需要一个能够运行在iPhone、iPad、Apple Watch以及MacBook上、并且能在这些平台上进行交互的通用的应用，可能还需要集成Apple的ARKit等框架，用Flutter恐怕难以实现，必须原生开发。
2. 等等……用Flutter是为了跨Apple之外的平台，可是我根本就不会在Android或是网页端上用它，我TM为什么闲得没事要用Flutter写啊？？！！

于是停止了Flutter项目的开发。转头学习iOS原生开发。希望重写现有功能，并继续改进。

* 2021年1月

发现iOS原生开发好难啊！学习了SwiftUI的基本使用，这框架和Flutter有很多相通的地方，所以我能比较轻松地理解。但是目前还不成熟，很多需要的东西还得靠UIKit。UIKit比这又难多了，我才不要去学！
还是用Flutter继续写吧……
把Flutter的项目作为iOS原生项目的模块，继续开发。

* 2021年6月

将Flutter作为模块开发，经历了许多麻烦。比如生成的iOS项目是临时的，每次pub get更新插件都会重置，我就得重新配置Firebase的文件。
那我为啥要作为模块啊？？我还想着原生+Flutter混合栈？别逗了，我有这水平吗。
还是把Flutter项目分出来了。
SwiftUI的项目存档，或许未来哪天又能用了呢？